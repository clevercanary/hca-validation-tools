id: https://github.com/clevercanary/hca-validation-tools/schema/sample
name: hca-validation-sample
title: HCA Validation Sample Schema
description: Schema for validating Human Cell Atlas (HCA) sample metadata
license: MIT
version: 0.1.0

prefixes:
  linkml: https://w3id.org/linkml/
  hca: https://github.com/clevercanary/hca-validation-tools/schema/

default_prefix: hca
default_range: string

imports:
  - linkml:types
  - ./slots

classes:
  Sample:
    description: >-
      A biological sample derived from a donor or another sample
    slots:
      - sample_id
      - donor_id
      - dataset_id
      - author_batch_notes
      - cell_number_loaded
      - cell_viability_percentage
      - institute
      - library_id
      - library_id_repository
      - library_preparation_batch
      - library_sequencing_run
      - sample_collection_year
      - sample_collection_site
      - sample_collection_relative_time_point
      - tissue_free_text

slots:
  author_batch_notes:
    title: Author Batch Notes
    description: >-
      Encoding of author knowledge on any further information related to likely batch effects.
    examples:
      - value: Batch run by different personnel on different days
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: string
    required: false
    multivalued: false
    comments: >-
      Space for author intuition of batch effects in their dataset

  cell_number_loaded:
    title: Cell Number Loaded
    description: >-
      Estimated number of cells loaded for library construction.
    examples:
      - value: "5000; 4000"
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: integer
    required: false
    multivalued: false
    comments: >-
      Can explain the number of doublets found in samples

  cell_viability_percentage:
    title: Cell Viability Percentage
    description: >-
      If measured, per sample cell viability before library preparation (as a percentage).
    examples:
      - value: "88; 95; 93.5"
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: decimal
    required: false
    multivalued: false
    comments: >-
      Is a measure of sample quality that could be used to explain outlier samples

  institute:
    title: Institute
    description: >-
      Institution where the samples were processed.
    examples:
      - value: EMBL-EBI; Genome Institute of Singapore
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: string
    required: true
    multivalued: false
    comments: >-
      To be able to link to other studies from the same institution as sometimes samples from different labs in the same institute are processed via similar core facilities. Thus batch effects may be smaller for datasets from the same institute even if other factors differ.

  library_id:
    title: Library ID
    description: >-
      The unique ID that is used to track libraries in the investigator's institution (should align with the publication).
    examples:
      - value: A24; NK_healthy_001
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: string
    required: true
    multivalued: false
    comments: >-
      A way to track the unit of data generation. This should include sample pooling

  library_id_repository:
    title: Library ID Repository
    description: >-
      The unique ID used to track libraries from one of the following public data repositories: EGAX*, GSM*, SRX*, ERX*, DRX, HRX, CRX.
    examples:
      - value: GSM1684095
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: string
    required: false
    multivalued: false
    comments: >-
      Links a dataset back to the source from which it was ingested, optional only if this is the same as the library_id.

  library_preparation_batch:
    title: Library Preparation Batch
    description: >-
      Indicating which samples' libraries were prepared in the same chip/plate/etc., e.g. batch1, batch2.
    examples:
      - value: batch01; batch02
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: string
    required: true
    multivalued: false
    comments: >-
      Sample preparation is a major source of batch effects.

  library_sequencing_run:
    title: Library Sequencing Run
    description: >-
      The identifier (or accession number) that indicates which samples' libraries were sequenced in the same run.
    examples:
      - value: run1; NV0087
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: string
    required: true
    multivalued: false
    comments: >-
      Library sequencing is a major source of batch effects

  sample_collection_year:
    title: Sample Collection Year
    description: >-
      Year of sample collection. Should not be detailed further (to exact month and day), to prevent identifiability.
    examples:
      - value: "2018"
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: string
    required: false
    multivalued: false
    comments: >-
      May explain whether a dataset was separated into smaller batches.

  sample_collection_site:
    title: Sample Collection Site
    description: >-
      The pseudonymised name of the site where the sample was collected.
    examples:
      - value: AIDA_site_1; AIDA_site_2
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: string
    required: false
    multivalued: false
    comments: >-
      To understand whether the collection site contributes to batch effects. It is strongly recommended that this identifier be designed so that it is unique to a given site within the collection of datasets that includes this site (for example, the labels 'site1', 'site2' may appear in other datasets thus rendering them indistinguishable).

  sample_collection_relative_time_point:
    title: Sample Collection Relative Time Point
    description: >-
      Time point when the sample was collected. This field is only needed if multiple samples from the same subject are available and collected at different time points. Sample collection dates (e.g. 23/09/22) cannot be used due to patient data protection, only relative time points should be used here (e.g. day3).
    examples:
      - value: sampleX_day1
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: string
    required: false
    multivalued: false
    comments: >-
      Explains variability in the data between samples from the same subject.

  tissue_free_text:
    title: Tissue Free Text
    description: >-
      The detailed anatomical location of the sample - this does not have to tie to an ontology term.
    examples:
      - value: terminal ileum
    annotations:
      annDataLocation: obs
      tier: Tier 1
    range: string
    required: false
    multivalued: false
    comments: >-
      To help the integration team understand the anatomical location of the sample, specifically to solve the problem when the UBERON ontology terms are insufficiently precise.

  sample_collection_method:
    title: Sample Collection Method
    description: The method the sample was physically obtained from the donor.
    range: SampleCollectionMethod
    required: true
    notes: "brush; scraping; biopsy; surgical resection; blood draw; body fluid; other"